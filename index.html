<script>
document.addEventListener("DOMContentLoaded", function () {
  function showSection(id) {
    document.querySelectorAll('.hero, .game-section').forEach(s => s.style.display='none');
    const el = document.getElementById(id);
    if(el) el.style.display='block';
  }
  window.showSection = showSection;
  showSection('hero');

  document.querySelectorAll('[data-section]').forEach(btn => {
    btn.addEventListener('click', () => showSection(btn.dataset.section));
  });

  const cases = [
    { name:"Red Case", price:0.50, thumbnail:"https://steamcdn-a.akamaihd.net/apps/730/icons/econ/default_generated/weapon_ak47_cu_redline_light_large.6e0c0f5b1c.png", skins:[
      { name:"AK-47 | Redline", rarity:"common", img:"https://steamcdn-a.akamaihd.net/apps/730/icons/econ/default_generated/weapon_ak47_cu_redline_light_large.6e0c0f5b1c.png", value:25},
      { name:"AWP | Asiimov", rarity:"rare", img:"https://steamcdn-a.akamaihd.net/apps/730/icons/econ/default_generated/weapon_awp_cu_asiimov_light_large.5f2a6f52ef.png", value:60},
      { name:"â˜… Karambit | Doppler", rarity:"legendary", img:"https://steamcdn-a.akamaihd.net/apps/730/icons/econ/default_generated/weapon_karambit_cu_doppler_light_large.0c1e21f6d3.png", value:950}
    ]},
    { name:"Blue Case", price:1.50, thumbnail:"https://steamcdn-a.akamaihd.net/apps/730/icons/econ/default_generated/weapon_m4a1_silencer_cu_howl_light_large.5d8d4b21.png", skins:[
      { name:"Desert Eagle | Blaze", rarity:"epic", img:"https://steamcdn-a.akamaihd.net/apps/730/icons/econ/default_generated/weapon_deagle_cu_blaze_light_large.1f2e6f2c.png", value:150},
      { name:"M4A4 | Howl", rarity:"legendary", img:"https://steamcdn-a.akamaihd.net/apps/730/icons/econ/default_generated/weapon_m4a1_silencer_cu_howl_light_large.5d8d4b21.png", value:800}
    ]}
  ];

  const caseCardsDiv = document.getElementById("caseCards");
  cases.forEach((c, i) => {
    const div = document.createElement("div");
    div.className="caseCard";
    div.innerHTML=`<img src="${c.thumbnail}"><h4>${c.name}</h4><p>â‚¬${c.price}</p>`;
    div.addEventListener('click', () => selectCase(i));
    caseCardsDiv.appendChild(div);
  });

  let selectedCase=null;
  function selectCase(i){
    selectedCase=cases[i];
    document.getElementById("caseOpenBox").style.display="flex";
    document.getElementById("openCaseBtn").style.display="inline-block";
    document.getElementById("caseStrip").innerHTML="";
    document.getElementById("caseStrip").style.transform="translateX(0)";
    document.getElementById("resultText").innerText="";
    document.getElementById("resultImg").style.display="none";
  }

  const openBtn=document.getElementById("openCaseBtn");
  openBtn.addEventListener('click', startCaseOpen);

  window.startCaseOpen=function(){
    if(!selectedCase) return;
    const strip=document.getElementById("caseStrip");
    const resultText=document.getElementById("resultText");
    const resultImg=document.getElementById("resultImg");
    strip.innerHTML="";
    strip.style.transition="none";
    strip.style.transform="translateX(0)";
    const total=30, center=Math.floor(total/2);
    const win=selectedCase.skins[Math.floor(Math.random()*selectedCase.skins.length)];
    for(let i=0;i<total;i++){
      const skin=i===center?win:selectedCase.skins[Math.floor(Math.random()*selectedCase.skins.length)];
      const div=document.createElement("div");
      div.className="caseItem "+skin.rarity;
      div.innerHTML=`<img src="${skin.img}" style="width:60px;height:60px;"><br>${skin.name}`;
      strip.appendChild(div);
    }
    requestAnimationFrame(()=>{
      strip.style.transition="transform 3.2s cubic-bezier(0.15,0.8,0.2,1)";
      strip.style.transform=`translateX(${-(center*100-180)}px)`;
    });
    setTimeout(()=>{
      resultText.innerHTML=`ðŸŽ‰ You won: <span style="color:#22c55e">${win.name}</span> (â‚¬${win.value})`;
      resultImg.src=win.img;
      resultImg.style.display="inline-block";
    },3300);
  };

});
</script>
